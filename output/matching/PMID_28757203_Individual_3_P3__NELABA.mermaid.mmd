graph LR

    subgraph CORE[Mechanistic Core]
        direction TB
        core_Combined_alpha_ketoacid_dehydrogenase_deficiency["Combined alpha-ketoacid dehydrogenase deficiency"]
        core_Decreased_protein_lipoylation["Decreased protein lipoylation"]
        core_Glycine_cleavage_system_dysfunction["Glycine cleavage system dysfunction"]
        core_Impaired_mitochondrial_lipoylation_via_LIPT2_deficiency["Impaired mitochondrial lipoylation via LIPT2 deficiency"]
        core_LIPT2_loss_of_function_variants["LIPT2 loss-of-function variants"]
        core_Lipoic_acid_supplementation_ineffective["Lipoic acid supplementation (ineffective)"]
        core_Reduced_PDHc_activity["Reduced PDHc activity"]
        core_Reduced_alpha_KGDHc_activity["Reduced alpha-KGDHc activity"]
        core_Supportive_care["Supportive care"]
    end

    subgraph MODEL_PHENOTYPES[Disease Model Phenotypes]
        direction TB
        model_Abnormal_cerebral_white_matter_morphology["MODEL: Abnormal cerebral white matter morphology<br/>[HP:0002500]"]
        model_Cerebral_atrophy["MODEL: Cerebral atrophy<br/>[HP:0002059]"]
        model_Delayed_myelination["MODEL: Delayed myelination<br/>[HP:0012448]"]
        model_Dystonia["MODEL: Dystonia<br/>[HP:0001332]"]
        model_Feeding_difficulties["MODEL: Feeding difficulties<br/>[HP:0008872]"]
        model_Global_developmental_delay["MODEL: Global developmental delay<br/>[HP:0012736]"]
        model_Hyperglycinemia["MODEL: Hyperglycinemia<br/>[HP:0002154]"]
        model_Lactic_acidosis["MODEL: Lactic acidosis<br/>[HP:0004902]"]
        model_Microcephaly["MODEL: Microcephaly<br/>[HP:0000252]"]
        model_Neonatal_hypotonia["MODEL: Neonatal hypotonia<br/>[HP:0001319]"]
        model_Polymicrogyria["MODEL: Polymicrogyria<br/>[HP:0002126]"]
        model_Respiratory_insufficiency["MODEL: Respiratory insufficiency<br/>[HP:0002093]"]
        model_Seizures["MODEL: Seizures<br/>[HP:0001250]"]
        model_Spasticity["MODEL: Spasticity<br/>[HP:0001257]"]
    end

    subgraph CASE_PHENOTYPES[Case Phenotypes]
        direction TB
        case_HP_0000252_17["CASE - Microcephaly<br/>[HP:0000252]"]
        case_HP_0001250_8["CASE - Seizure<br/>[HP:0001250]"]
        case_HP_0001252_1["CASE + Hypotonia<br/>[HP:0001252]"]
        case_HP_0001263_2["CASE + Global developmental delay<br/>[HP:0001263]"]
        case_HP_0001285_3["CASE - Spastic tetraparesis<br/>[HP:0001285]"]
        case_HP_0001298_7["CASE + Encephalopathy<br/>[HP:0001298]"]
        case_HP_0002093_16["CASE + Respiratory insufficiency<br/>[HP:0002093]"]
        case_HP_0002119_13["CASE + Ventriculomegaly<br/>[HP:0002119]"]
        case_HP_0002120_11["CASE - Cerebral cortical atrophy<br/>[HP:0002120]"]
        case_HP_0002151_15["CASE + Increased circulating lactate concentration<br/>[HP:0002151]"]
        case_HP_0002154_5["CASE + Hyperglycinemia<br/>[HP:0002154]"]
        case_HP_0002188_12["CASE - Delayed CNS myelination<br/>[HP:0002188]"]
        case_HP_0003128_14["CASE + Lactic acidosis<br/>[HP:0003128]"]
        case_HP_0003348_4["CASE + Hyperalaninemia<br/>[HP:0003348]"]
        case_HP_0007109_10["CASE + Periventricular cysts<br/>[HP:0007109]"]
        case_HP_0009879_9["CASE + Simplified gyral pattern<br/>[HP:0009879]"]
        case_HP_0031518_6["CASE - Absent posterior alpha rhythm<br/>[HP:0031518]"]
    end

    subgraph EXPLANATIONS[Explanations]
        direction TB
        exp_CASE_TERM_LESS_SPECIFIC["EXP: CASE_TERM_LESS_SPECIFIC<br/>Pr=0.99<br/>The case report used a broader HPO term for what is clearly the same clinical finding a..."]
        exp_CASE_TERM_MORE_SPECIFIC["EXP: CASE_TERM_MORE_SPECIFIC<br/>Pr=0.99<br/>The case report encoded a more specific subtype of a finding already captured by a broa..."]
        exp_EXCLUDED_INCIDENTAL_FINDING["EXP: EXCLUDED_INCIDENTAL_FINDING<br/>Pr=0.99<br/>A specific clinical test finding that was noted as excluded in the case and is not part..."]
        exp_EXCLUDED_NARROWER_DOES_NOT_EXCLUDE_BROADER["EXP: EXCLUDED_NARROWER_DOES_NOT_EXCLUDE_BROADER<br/>Pr=0.95<br/>The case excluded a narrower subtype (spastic tetraparesis) but the model lists the bro..."]
        exp_EXPECTED_BIOCHEMICAL_CONSEQUENCE["EXP: EXPECTED_BIOCHEMICAL_CONSEQUENCE<br/>Pr=0.99<br/>The case finding is a direct biochemical consequence of the disease mechanism (PDHc def..."]
        exp_EXPECTED_SECONDARY_FINDING["EXP: EXPECTED_SECONDARY_FINDING<br/>Pr=0.95<br/>Ventriculomegaly is a common secondary neuroimaging finding that accompanies the cortic..."]
        exp_NO_EXPLANATION["EXP: NO_EXPLANATION<br/>Pr=0<br/>No explanation assigned yet for this non-match."]
        exp_PHENOTYPIC_VARIABILITY_BRAIN_MALFORMATION["EXP: PHENOTYPIC_VARIABILITY_BRAIN_MALFORMATION<br/>Pr=0.9<br/>P3 showed simplified gyral pattern while the model lists polymicrogyria (from another p..."]
        exp_REDUNDANT_WITH_MODEL_TERM["EXP: REDUNDANT_WITH_MODEL_TERM<br/>Pr=0.99<br/>The case finding is an overlapping or near-equivalent way to express a biochemical abno..."]
        exp_SUBSUMED_BY_DISEASE_DEFINITION["EXP: SUBSUMED_BY_DISEASE_DEFINITION<br/>Pr=0.99<br/>The finding is the core clinical entity of the disease (encephalopathy is in the diseas..."]
        exp_VARIABLE_EXPRESSIVITY["EXP: VARIABLE_EXPRESSIVITY<br/>Pr=0.9<br/>The feature is present in the disease model based on observations in other reported NEL..."]
    end

    case_HP_0000252_17 --> model_Microcephaly
    case_HP_0001250_8 --> model_Seizures
    case_HP_0001252_1 -.-> model_Neonatal_hypotonia
    case_HP_0001263_2 -.-> model_Global_developmental_delay
    case_HP_0001285_3 -.-> model_Spasticity
    case_HP_0002093_16 --> model_Respiratory_insufficiency
    case_HP_0002120_11 -.-> model_Cerebral_atrophy
    case_HP_0002154_5 --> model_Hyperglycinemia
    case_HP_0002188_12 -.-> model_Delayed_myelination
    case_HP_0003128_14 -.-> model_Lactic_acidosis
    case_HP_0007109_10 -.-> model_Abnormal_cerebral_white_matter_morphology

    case_HP_0001252_1 -.-> exp_CASE_TERM_LESS_SPECIFIC
    case_HP_0001263_2 -.-> exp_CASE_TERM_LESS_SPECIFIC
    case_HP_0001285_3 -.-> exp_EXCLUDED_NARROWER_DOES_NOT_EXCLUDE_BROADER
    case_HP_0001298_7 -.-> exp_SUBSUMED_BY_DISEASE_DEFINITION
    case_HP_0002119_13 -.-> exp_EXPECTED_SECONDARY_FINDING
    case_HP_0002120_11 -.-> exp_VARIABLE_EXPRESSIVITY
    case_HP_0002151_15 -.-> exp_REDUNDANT_WITH_MODEL_TERM
    case_HP_0002188_12 -.-> exp_VARIABLE_EXPRESSIVITY
    case_HP_0003128_14 -.-> exp_CASE_TERM_LESS_SPECIFIC
    case_HP_0003348_4 -.-> exp_EXPECTED_BIOCHEMICAL_CONSEQUENCE
    case_HP_0007109_10 -.-> exp_CASE_TERM_MORE_SPECIFIC
    case_HP_0009879_9 -.-> exp_PHENOTYPIC_VARIABILITY_BRAIN_MALFORMATION
    case_HP_0031518_6 -.-> exp_EXCLUDED_INCIDENTAL_FINDING
    model_Abnormal_cerebral_white_matter_morphology -.-> exp_CASE_TERM_MORE_SPECIFIC
    model_Cerebral_atrophy -.-> exp_VARIABLE_EXPRESSIVITY
    model_Delayed_myelination -.-> exp_VARIABLE_EXPRESSIVITY
    model_Dystonia -.-> exp_VARIABLE_EXPRESSIVITY
    model_Feeding_difficulties -.-> exp_VARIABLE_EXPRESSIVITY
    model_Global_developmental_delay -.-> exp_CASE_TERM_LESS_SPECIFIC
    model_Lactic_acidosis -.-> exp_CASE_TERM_LESS_SPECIFIC
    model_Neonatal_hypotonia -.-> exp_CASE_TERM_LESS_SPECIFIC
    model_Polymicrogyria -.-> exp_VARIABLE_EXPRESSIVITY
    model_Spasticity -.-> exp_EXCLUDED_NARROWER_DOES_NOT_EXCLUDE_BROADER

    classDef core_pathophysiology fill:#dbeafe,stroke:#1e3a8a,stroke-width:1px
    classDef core_environmental fill:#dcfce7,stroke:#166534,stroke-width:1px
    classDef core_genetic fill:#f3e8ff,stroke:#6b21a8,stroke-width:1px
    classDef core_treatment fill:#fce7f3,stroke:#9d174d,stroke-width:1px
    classDef core_biochemical fill:#e0e7ff,stroke:#3730a3,stroke-width:1px
    classDef core_other fill:#f3f4f6,stroke:#6b7280,stroke-width:1px
    classDef orphan fill:#fee2e2,stroke:#dc2626,stroke-width:1px,stroke-dasharray:5 5
    classDef model_exact_present fill:#86efac,stroke:#15803d,stroke-width:2px
    classDef model_exact_absent fill:#fde047,stroke:#a16207,stroke-width:2px
    classDef model_related fill:#93c5fd,stroke:#1d4ed8,stroke-width:2px
    classDef model_unmatched fill:#fca5a5,stroke:#b91c1c,stroke-width:2px
    classDef case_present fill:#bbf7d0,stroke:#166534,stroke-width:1px
    classDef case_absent fill:#f3f4f6,stroke:#6b7280,stroke-width:1px,stroke-dasharray:5 3
    classDef case_unknown fill:#e5e7eb,stroke:#6b7280,stroke-width:1px
    classDef explanation fill:#ddd6fe,stroke:#5b21b6,stroke-width:1px
    classDef explanation_default fill:#fee2e2,stroke:#b91c1c,stroke-width:1px,stroke-dasharray:5 3

    class core_Combined_alpha_ketoacid_dehydrogenase_deficiency core_pathophysiology
    class core_Decreased_protein_lipoylation core_biochemical
    class core_Glycine_cleavage_system_dysfunction core_pathophysiology
    class core_Impaired_mitochondrial_lipoylation_via_LIPT2_deficiency core_pathophysiology
    class core_LIPT2_loss_of_function_variants core_genetic
    class core_Lipoic_acid_supplementation_ineffective core_treatment
    class core_Reduced_PDHc_activity core_biochemical
    class core_Reduced_alpha_KGDHc_activity core_biochemical
    class core_Supportive_care core_treatment
    class model_Abnormal_cerebral_white_matter_morphology model_related
    class model_Cerebral_atrophy model_related
    class model_Delayed_myelination model_related
    class model_Dystonia model_unmatched
    class model_Feeding_difficulties model_unmatched
    class model_Global_developmental_delay model_related
    class model_Hyperglycinemia model_exact_present
    class model_Lactic_acidosis model_related
    class model_Microcephaly model_exact_absent
    class model_Neonatal_hypotonia model_related
    class model_Polymicrogyria model_unmatched
    class model_Respiratory_insufficiency model_exact_present
    class model_Seizures model_exact_absent
    class model_Spasticity model_related
    class case_HP_0000252_17 case_absent
    class case_HP_0001250_8 case_absent
    class case_HP_0001252_1 case_present
    class case_HP_0001263_2 case_present
    class case_HP_0001285_3 case_absent
    class case_HP_0001298_7 case_present
    class case_HP_0002093_16 case_present
    class case_HP_0002119_13 case_present
    class case_HP_0002120_11 case_absent
    class case_HP_0002151_15 case_present
    class case_HP_0002154_5 case_present
    class case_HP_0002188_12 case_absent
    class case_HP_0003128_14 case_present
    class case_HP_0003348_4 case_present
    class case_HP_0007109_10 case_present
    class case_HP_0009879_9 case_present
    class case_HP_0031518_6 case_absent
    class exp_CASE_TERM_LESS_SPECIFIC explanation
    class exp_CASE_TERM_MORE_SPECIFIC explanation
    class exp_EXCLUDED_INCIDENTAL_FINDING explanation
    class exp_EXCLUDED_NARROWER_DOES_NOT_EXCLUDE_BROADER explanation
    class exp_EXPECTED_BIOCHEMICAL_CONSEQUENCE explanation
    class exp_EXPECTED_SECONDARY_FINDING explanation
    class exp_NO_EXPLANATION explanation_default
    class exp_PHENOTYPIC_VARIABILITY_BRAIN_MALFORMATION explanation
    class exp_REDUNDANT_WITH_MODEL_TERM explanation
    class exp_SUBSUMED_BY_DISEASE_DEFINITION explanation
    class exp_VARIABLE_EXPRESSIVITY explanation
